<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>浜田高校オープンスクール</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@700;800&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* フォント設定 */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #f0f4f8;
        }
        h1, h2, h3 {
            font-family: 'M PLUS Rounded 1c', sans-serif;
        }
        /* 見出しのグラデーション背景 */
        .header-gradient {
            background: linear-gradient(135deg, #81d4fa, #4fc3f7, #29b6f6);
        }
        /* ローディングスピナー */
        .loader {
            border: 4px solid #f3f3f3;
            border-radius: 50%;
            border-top: 4px solid #3498db;
            width: 24px;
            height: 24px;
            animation: spin 2s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50">

    <div class="container mx-auto p-4 max-w-6xl">

        <!-- ヘッダー -->
        <header class="header-gradient text-white p-6 rounded-xl shadow-lg mb-8">
            <h1 class="text-4xl md:text-5xl font-extrabold text-center tracking-wider">浜田高校オープンスクール</h1>
        </header>

        <main class="grid grid-cols-1 md:grid-cols-3 gap-8">

            <!-- 左側コンテンツ -->
            <div class="md:col-span-2 space-y-8">
                <!-- 詳細情報セクション -->
                <section class="bg-white p-8 rounded-xl shadow-md">
                    <h2 class="text-2xl font-bold text-gray-800 border-b-4 border-blue-400 pb-2 mb-6">オープンスクールの詳細</h2>
                    <div class="space-y-4 text-gray-700">
                        <p><strong>開催日時:</strong> 2025年8月23日（土） 9:00 〜 12:00 (受付開始 8:30)</p>
                        <p><strong>場所:</strong> 島根県立浜田高等学校 各教室・体育館</p>
                        <p><strong>対象:</strong> 中学生およびその保護者、中学校教員</p>
                        <p><strong>内容:</strong></p>
                        <ul class="list-disc list-inside pl-4 space-y-2">
                            <li>学校概要説明</li>
                            <li>体験授業（国語、数学、理科、社会、英語など）</li>
                            <li>部活動見学・体験</li>
                            <li>在校生との交流会</li>
                            <li>個別相談コーナー</li>
                        </ul>
                        <p class="mt-4">浜田高校の魅力を存分に感じていただけるプログラムを多数ご用意しています。ぜひ、ご参加ください！</p>
                         <button class="mt-6 w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-transform transform hover:scale-105">
                            参加申し込みはこちら
                        </button>
                    </div>
                </section>

                <!-- ★新規追加: パーソナルプランナーセクション -->
                <section class="bg-white p-8 rounded-xl shadow-md">
                    <h2 class="text-2xl font-bold text-gray-800 border-b-4 border-green-400 pb-2 mb-6">✨ オープンスクール・パーソナルプランナー</h2>
                    <p class="text-gray-600 mb-4">あなたの興味に合わせて、おすすめの1日のプランをAIが提案します！</p>
                    <div class="space-y-4">
                        <div>
                            <h3 class="font-semibold text-gray-700">興味のある教科は？ (複数選択可)</h3>
                            <div id="subject-interests" class="grid grid-cols-2 sm:grid-cols-3 gap-2 mt-2">
                                <label class="flex items-center space-x-2 p-2 rounded-lg bg-gray-100 hover:bg-gray-200 cursor-pointer"><input type="checkbox" value="国語" class="form-checkbox h-5 w-5 text-blue-500"><span>国語</span></label>
                                <label class="flex items-center space-x-2 p-2 rounded-lg bg-gray-100 hover:bg-gray-200 cursor-pointer"><input type="checkbox" value="数学" class="form-checkbox h-5 w-5 text-blue-500"><span>数学</span></label>
                                <label class="flex items-center space-x-2 p-2 rounded-lg bg-gray-100 hover:bg-gray-200 cursor-pointer"><input type="checkbox" value="理科" class="form-checkbox h-5 w-5 text-blue-500"><span>理科</span></label>
                                <label class="flex items-center space-x-2 p-2 rounded-lg bg-gray-100 hover:bg-gray-200 cursor-pointer"><input type="checkbox" value="社会" class="form-checkbox h-5 w-5 text-blue-500"><span>社会</span></label>
                                <label class="flex items-center space-x-2 p-2 rounded-lg bg-gray-100 hover:bg-gray-200 cursor-pointer"><input type="checkbox" value="英語" class="form-checkbox h-5 w-5 text-blue-500"><span>英語</span></label>
                            </div>
                        </div>
                         <div>
                            <h3 class="font-semibold text-gray-700">興味のある部活動は？</h3>
                             <div id="club-interests" class="flex flex-wrap gap-2 mt-2">
                                <label class="flex items-center space-x-2 p-2 rounded-lg bg-gray-100 hover:bg-gray-200 cursor-pointer"><input type="radio" name="club" value="運動部" class="form-radio h-5 w-5 text-blue-500"><span>運動部</span></label>
                                <label class="flex items-center space-x-2 p-2 rounded-lg bg-gray-100 hover:bg-gray-200 cursor-pointer"><input type="radio" name="club" value="文化部" class="form-radio h-5 w-5 text-blue-500"><span>文化部</span></label>
                                <label class="flex items-center space-x-2 p-2 rounded-lg bg-gray-100 hover:bg-gray-200 cursor-pointer"><input type="radio" name="club" value="どちらも" class="form-radio h-5 w-5 text-blue-500"><span>どちらも</span></label>
                            </div>
                        </div>
                        <button id="create-plan-btn" class="mt-4 w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-transform transform hover:scale-105 flex items-center justify-center">
                            ✨ あなただけのプランを作成
                        </button>
                    </div>
                    <div id="plan-result" class="mt-6 p-6 bg-green-50 rounded-lg border border-green-200" style="display: none;">
                        <!-- AIからの提案がここに表示される -->
                    </div>
                </section>

                 <!-- 在校生の感想セクション -->
                <section class="bg-white p-8 rounded-xl shadow-md">
                    <h2 class="text-2xl font-bold text-gray-800 border-b-4 border-teal-400 pb-2 mb-6">在校生からのメッセージ</h2>
                    <div id="student-message-1" class="flex items-start space-x-6">
                        <div class="w-20 h-20 rounded-full bg-teal-500 flex-shrink-0 flex items-center justify-center text-white text-3xl font-bold shadow-lg">
                            <span>声</span>
                        </div>
                        <div class="bg-teal-50 p-6 rounded-lg flex-grow">
                            <p class="font-semibold text-teal-800">「最初は緊張したけど、先輩たちが優しく教えてくれて、授業も部活もすごく楽しかったです！浜高の雰囲気がよく分かりました。」</p>
                            <p class="text-right mt-2 text-sm text-gray-600">- 普通科2年 女子</p>
                        </div>
                    </div>
                     <div id="student-message-2" class="flex items-start space-x-6 mt-6">
                        <div class="w-20 h-20 rounded-full bg-orange-500 flex-shrink-0 flex items-center justify-center text-white text-3xl font-bold shadow-lg">
                            <span>声</span>
                        </div>
                        <div class="bg-orange-50 p-6 rounded-lg flex-grow">
                            <p class="font-semibold text-orange-800">「体験授業で高校の勉強のレベルの高さを感じました。難しいけど面白そうで、ますます浜高で学びたくなりました。」</p>
                            <p class="text-right mt-2 text-sm text-gray-600">- 理数科志望 男子</p>
                        </div>
                    </div>
                     <button id="new-message-btn" class="mt-6 w-full bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-transform transform hover:scale-105 flex items-center justify-center">
                        ✨ 新しいメッセージを見る
                    </button>
                </section>

                <!-- 校長先生の紹介セクション -->
                <section class="bg-white p-8 rounded-xl shadow-md">
                    <h2 class="text-2xl font-bold text-gray-800 border-b-4 border-purple-400 pb-2 mb-6">校長先生からのご挨拶</h2>
                    <div class="flex flex-col sm:flex-row items-center gap-6">
                        <div class="flex-shrink-0">
                            <img src="https://placehold.co/150x150/a78bfa/ffffff?text=校長先生" alt="" class="rounded-full shadow-lg object-cover">
                        </div>
                        <div class="flex-grow">
                            <p class="text-gray-700">
                                中学生の皆さん、こんにちは。浜田高校のオープンスクールへようこそ。<br>
                                本校は、長い歴史と伝統の中で「石見の雄」として地域社会を担う人材を育成してまいりました。このオープンスクールでは、活気あふれる授業や部活動、そして何より生徒たちの自主性を重んじる校風を肌で感じていただきたいと思います。<br>
                               皆さんが自らの夢を見つけ、挑戦できるよう、我々教職員一同、全力でサポートします。今日一日が、皆さんにとって有意義な時間となることを心より願っています。
                            </p>
                            <div class="mt-4 text-right">
                                <p class="font-semibold text-gray-700">島根県立浜田高等学校 校長</p>
                                <p class="font-bold text-xl text-gray-800">志波 英樹</p>
                            </div>
                        </div>
                    </div>
                </section>

            </div>

            <!-- 右側コンテンツ（写真） -->
            <div class="md:col-span-1 space-y-8">
                <section class="bg-white p-6 rounded-xl shadow-md">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">キャンパス風景</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <img src="https://www.hamada-h.ed.jp/wp-content/uploads/2023/04/IMG_3962-1024x768.jpg" alt="浜田高校 桜と校舎" class="rounded-lg shadow-md w-full h-auto object-cover aspect-square" onerror="this.onerror=null;this.src='https://placehold.co/400x300/cccccc/ffffff?text=画像読込エラー';">
                        <img src="https://www.hamada-h.ed.jp/wp-content/uploads/2021/04/P1000305-1024x768.jpg" alt="浜田高校 正門" class="rounded-lg shadow-md w-full h-auto object-cover aspect-square" onerror="this.onerror=null;this.src='https://placehold.co/400x300/cccccc/ffffff?text=画像読込エラー';">
                        <img src="https://www.hamada-h.ed.jp/wp-content/uploads/2021/04/P1000304-1024x768.jpg" alt="浜田高校 くすのき" class="rounded-lg shadow-md w-full h-auto object-cover aspect-square" onerror="this.onerror=null;this.src='https://placehold.co/400x300/cccccc/ffffff?text=画像読込エラー';">
                        <img src="https://www.hamada-h.ed.jp/wp-content/uploads/2021/04/P1000302-1024x768.jpg" alt="浜田高校 校舎遠景" class="rounded-lg shadow-md w-full h-auto object-cover aspect-square" onerror="this.onerror=null;this.src='https://placehold.co/400x300/cccccc/ffffff?text=画像読込エラー';">
                    </div>
                </section>
                <section class="bg-white p-6 rounded-xl shadow-md">
                     <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">学校のシンボル</h3>
                     <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Shimane_Prefectural_Hamada_High_School.JPG/1200px-Shimane_Prefectural_Hamada_High_School.JPG" alt="島根県立浜田高等学校の校舎" class="rounded-lg shadow-md w-full h-auto" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/ffffff?text=画像読込エラー';">
                </section>
            </div>
        </main>

        <!-- フッター -->
        <footer class="text-center text-sm text-gray-600 bg-white mt-8 p-6 rounded-xl shadow-md">
            <p class="font-bold text-lg">島根県立浜田高等学校</p>
            <p>〒697-0024 島根県浜田市黒川町3749番地</p>
            <p>TEL: 0855-22-0042</p>
        </footer>
    </div>

    <script type="module">
        // Gemini APIを呼び出す汎用関数
        async function callGemini(prompt) {
            const apiKey = ""; // APIキーは空のままにしてください
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{
                    role: "user",
                    parts: [{ text: prompt }]
                }],
                generationConfig: {
                    temperature: 0.7,
                    topP: 1.0,
                }
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API request failed with status ${response.status}`);
                }

                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    return result.candidates[0].content.parts[0].text;
                } else {
                    console.error('Unexpected API response structure:', result);
                    // ユーザーへのフォールバックメッセージ
                    return "AIからの応答がありませんでした。後ほどもう一度お試しください。";
                }
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                return "エラーが発生しました。しばらくしてからもう一度お試しください。";
            }
        }

        // --- パーソナルプランナー機能 ---
        const createPlanBtn = document.getElementById('create-plan-btn');
        const planResultEl = document.getElementById('plan-result');

        createPlanBtn.addEventListener('click', async () => {
            // ユーザーの選択を取得
            const selectedSubjects = Array.from(document.querySelectorAll('#subject-interests input:checked')).map(el => el.value);
            const selectedClub = document.querySelector('#club-interests input:checked')?.value;

            if (selectedSubjects.length === 0 || !selectedClub) {
                planResultEl.innerHTML = '<p class="text-red-600 font-bold">教科と部活動の両方を選択してください。</p>';
                planResultEl.style.display = 'block';
                return;
            }

            // ローディング表示
            planResultEl.style.display = 'block';
            planResultEl.innerHTML = '<div class="flex justify-center items-center"><div class="loader"></div><p class="ml-4">AIがプランを作成中です...</p></div>';
            createPlanBtn.disabled = true;

            // プロンプトを作成
            const prompt = `
                あなたは島根県立浜田高等学校の親切な進路指導の先生です。ある中学生がオープンスクールに参加します。以下の情報に基づいて、その生徒に最適なオープンスクールの体験プランを提案してください。

                # オープンスクールの基本スケジュール
                - 9:00 - 9:30: 全体説明会（体育館）
                - 9:40 - 10:30: 体験授業（各教室）
                - 10:40 - 11:30: 部活動見学・体験
                - 11:30 - 12:00: 在校生との交流会・個別相談

                # 生徒の興味・関心
                - 興味のある教科: ${selectedSubjects.join('、')}
                - 興味のある部活の種類: ${selectedClub}

                # 出力形式
                以下の見出しとリスト形式で、具体的な時間と行動を盛り込んだ、生徒がワクワクするようなパーソナルプランを提案してください。フレンドリーな口調でお願いします。

                ### あなたにピッタリのおすすめプラン！
                - **9:00〜9:30:**
                - **9:40〜10:30:**
                - **10:40〜11:30:**
                - **11:30〜12:00:**
            `;
            
            // Gemini APIを呼び出し
            const resultText = await callGemini(prompt);
            
            // 結果を表示 (簡易的なMarkdownをHTMLに変換)
            let htmlResult = resultText
                .replace(/### (.*)/g, '<h3 class="text-xl font-bold text-green-800 mb-3">$1</h3>')
                .replace(/\* \*\*(.*?):\*\*/g, '<p class="mb-2"><strong>$1:</strong>')
                .replace(/^- (.*)/gm, '<li class="list-disc list-inside ml-4 mb-1">$1</li>')
                .replace(/\n/g, '<br>');

            planResultEl.innerHTML = htmlResult;
            createPlanBtn.disabled = false;
        });

        // --- 在校生メッセージ機能 ---
        const newMessageBtn = document.getElementById('new-message-btn');
        const messageContainer1 = document.getElementById('student-message-1');
        
        newMessageBtn.addEventListener('click', async () => {
             // ローディング表示
            const originalContent = messageContainer1.innerHTML;
            messageContainer1.innerHTML = '<div class="w-full flex justify-center items-center p-8"><div class="loader"></div><p class="ml-4">新しいメッセージを生成中...</p></div>';
            newMessageBtn.disabled = true;

            const prompt = `あなたは島根県立浜田高等学校の在校生です。オープンスクールに来てくれた中学生に向けて、浜田高校の魅力が伝わるような、短くて元気の出る応援メッセージを1つ作成してください。文の最後には「- 〇〇科〇年 〇〇」のように、学年と性別などを付け加えてください。少しくだけた、親しみやすい口調でお願いします。`;

            const resultText = await callGemini(prompt);

            const [message, author] = resultText.split(/(- .*)/s).filter(Boolean);

            const newHTML = `
                <div class="w-20 h-20 rounded-full bg-pink-500 flex-shrink-0 flex items-center justify-center text-white text-3xl font-bold shadow-lg">
                    <span>新</span>
                </div>
                <div class="bg-pink-50 p-6 rounded-lg flex-grow">
                    <p class="font-semibold text-pink-800">${message.trim()}</p>
                    <p class="text-right mt-2 text-sm text-gray-600">${author ? author.trim() : ''}</p>
                </div>
            `;
            
            messageContainer1.innerHTML = newHTML;
            newMessageBtn.disabled = false;
        });

    </script>
</body>
</html>
